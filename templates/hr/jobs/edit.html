{% extends "base.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/pages/hrcrudjobs.css' %}">
{% endblock %}

{% block content %}

<div class="hrjob-wrapper">
    <div class="hrjob-card">

        <h2 class="hrjob-title">Edit Job</h2>

        <!-- FORM-LEVEL ERRORS -->
        {% if form.errors %}
        <div style="background:#fee2e2; color:#991b1b; padding:12px; margin-bottom:18px; border-radius:6px;">
            <strong>Please fix the following errors:</strong>
            <ul>
                {% for field, errors in form.errors.items %}
                    <li>
                        <strong>{{ field|capfirst }}:</strong>
                        {{ errors|striptags }}
                    </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}

        <form method="POST" class="hrjob-form">
            {% csrf_token %}

            {% for field in form %}
                <div class="hrjob-field {% if field.field.required %}required{% endif %}">

                    <label for="{{ field.id_for_label }}">
                        {{ field.label }}
                    </label>

                    {{ field }}

                    {% if field.help_text %}
                        <small class="text-muted">
                            {{ field.help_text }}
                        </small>
                    {% endif %}   

                    {% if field.errors %}
                        <div class="text-danger small mt-1">
                            {{ field.errors }}
                        </div>
                    {% endif %}

                </div>
            {% endfor %}

            <div style="margin-top: 30px; display: flex; gap: 12px;">

                <!-- Update & Go Back to List -->
                <button type="submit"
                        name="action"
                        value="save_list"
                        class="hrjob-btn">
                    Update → List
                </button>

                <!-- Update & View Details -->
                <button type="submit"
                        name="action"
                        value="save_detail"
                        class="hrjob-btn"
                        style="background:#047857;">
                    Update → Details
                </button>

            </div>

        </form>

    </div>
</div>

<!-- Salary placeholder logic -->
<script>
document.addEventListener("DOMContentLoaded", function () {
    const salaryType = document.getElementById("id_salary_type");
    const minField = document.getElementById("id_min_salary");
    const maxField = document.getElementById("id_max_salary");

    function updatePlaceholders() {
        if (!salaryType || !minField || !maxField) return;

        if (salaryType.value === "yearly") {
            minField.placeholder = "E.g. 4 (LPA)";
            maxField.placeholder = "E.g. 8 (LPA)";
        } else if (salaryType.value === "monthly") {
            minField.placeholder = "E.g. 30000";
            maxField.placeholder = "E.g. 60000";
        } else {
            minField.placeholder = "";
            maxField.placeholder = "";
        }
    }

    salaryType.addEventListener("change", updatePlaceholders);
    updatePlaceholders();
});
</script>

{% endblock %}
